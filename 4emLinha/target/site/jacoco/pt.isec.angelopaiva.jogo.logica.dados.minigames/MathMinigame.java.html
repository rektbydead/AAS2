<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MathMinigame.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">4-em-linha</a> &gt; <a href="index.source.html" class="el_package">pt.isec.angelopaiva.jogo.logica.dados.minigames</a> &gt; <span class="el_source">MathMinigame.java</span></div><h1>MathMinigame.java</h1><pre class="source lang-java linenums">package pt.isec.angelopaiva.jogo.logica.dados.minigames;

import java.text.DecimalFormat;
import java.util.concurrent.ThreadLocalRandom;

public class MathMinigame extends MinigameAdapter {
    private static final int REQUIRED_NR_RIGHT_ANSWERS = 5;
    private static final int MAX_SECONDS = 30;

<span class="fc" id="L10">    private int nrRightAnswers = 0;</span>
    private double lastSolution;

<span class="fc" id="L13">    public MathMinigame() {</span>
<span class="fc" id="L14">        setMaxSeconds(MAX_SECONDS);</span>
<span class="fc" id="L15">        startTimer();</span>
<span class="fc" id="L16">    }</span>

    @Override
    public String getQuestion() {
<span class="fc" id="L20">        DecimalFormat decimalFormat = new DecimalFormat(&quot;#.##&quot;);</span>

<span class="fc" id="L22">        int a = getRandomTwoDigitInt();</span>
<span class="fc" id="L23">        int b = getRandomTwoDigitInt();</span>
<span class="fc" id="L24">        Operators o = getRandomOperator();</span>

<span class="pc bpc" id="L26" title="1 of 5 branches missed.">        switch (o) {</span>
<span class="fc" id="L27">            case ADDITION -&gt; lastSolution = (double) a + b;</span>
<span class="fc" id="L28">            case SUBTRACTION -&gt; lastSolution = (double) a - b;</span>
<span class="fc" id="L29">            case DIVISION -&gt; lastSolution = (double) a / b;</span>
<span class="fc" id="L30">            case MULTIPLICATION -&gt; lastSolution = (double) a * b;</span>
        }

<span class="fc" id="L33">        String x = decimalFormat.format(lastSolution);</span>

<span class="fc" id="L35">        lastSolution = Double.parseDouble(x);</span>

<span class="fc" id="L37">        return String.format(&quot;%d %c %d = &quot;, a, o.operator, b);</span>
    }

    @Override
    public void setAnswer(String answer) {
<span class="fc bfc" id="L42" title="All 4 branches covered.">        if (answer == null || answer.isBlank()) return;</span>

        double doubleAnswer;

        try {
<span class="fc" id="L47">            doubleAnswer = Double.parseDouble(answer);</span>
<span class="fc" id="L48">        } catch (NumberFormatException e) {</span>
<span class="fc" id="L49">            return;</span>
<span class="fc" id="L50">        }</span>

<span class="fc bfc" id="L52" title="All 2 branches covered.">        if (doubleAnswer == lastSolution) nrRightAnswers++;</span>

<span class="fc" id="L54">        finished = true;</span>

<span class="fc bfc" id="L56" title="All 2 branches covered.">        if (nrRightAnswers &lt; REQUIRED_NR_RIGHT_ANSWERS) finished = hasTimedOut();</span>

<span class="fc bfc" id="L58" title="All 2 branches covered.">        if (finished) stopTimer();</span>
<span class="fc" id="L59">    }</span>

    @Override
<span class="nc" id="L62">    public String getWording() { return &quot;Resolva a operação (arredondada a 2 casas decimais)&quot;; }</span>

    @Override
<span class="pc bpc" id="L65" title="1 of 4 branches missed.">    public boolean hasWon() { return nrRightAnswers &gt;= REQUIRED_NR_RIGHT_ANSWERS &amp;&amp; super.hasWon(); }</span>

<span class="fc" id="L67">    private int getRandomTwoDigitInt() { return ThreadLocalRandom.current().nextInt(0, 100); }</span>
<span class="fc" id="L68">    private Operators getRandomOperator() { return Operators.values()[ThreadLocalRandom.current().nextInt(Operators.values().length)]; }</span>

<span class="fc" id="L70">    private enum Operators {</span>
<span class="fc" id="L71">        ADDITION('+'),</span>
<span class="fc" id="L72">        SUBTRACTION('-'),</span>
<span class="fc" id="L73">        DIVISION('/'),</span>
<span class="fc" id="L74">        MULTIPLICATION('*');</span>

        char operator;

<span class="fc" id="L78">        Operators(char operator) { this.operator = operator; }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>